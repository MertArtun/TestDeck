import{_ as T,r as y}from"./index-5afd821c.js";function v(e,t,a=0){const r=Number(e)||0,n=Number(t)||0;if(n<=0||r<0)return a;const i=r/n*100;return isNaN(i)||!isFinite(i)?a:Math.round(i)}function I(e,t=0){const a=Number(e);return isNaN(a)||!isFinite(a)?t:Math.round(a)}function M(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function h(e,t=!1){const a=M(),r=`_${a}`;return Object.defineProperty(window,r,{value:n=>(t&&Reflect.deleteProperty(window,r),e==null?void 0:e(n)),writable:!1,configurable:!0}),a}async function F(e,t={}){return new Promise((a,r)=>{const n=h(l=>{a(l),Reflect.deleteProperty(window,`_${i}`)},!0),i=h(l=>{r(l),Reflect.deleteProperty(window,`_${n}`)},!0);window.__TAURI_IPC__({cmd:e,callback:n,error:i,...t})})}async function c(e){return F("tauri",e)}async function L(e={}){return typeof e=="object"&&Object.freeze(e),c({__tauriModule:"Dialog",message:{cmd:"openDialog",options:e}})}async function S(e={}){return typeof e=="object"&&Object.freeze(e),c({__tauriModule:"Dialog",message:{cmd:"saveDialog",options:e}})}async function x(e,t){var a,r;const n=typeof t=="string"?{title:t}:t;return c({__tauriModule:"Dialog",message:{cmd:"messageDialog",message:e.toString(),title:(a=n==null?void 0:n.title)===null||a===void 0?void 0:a.toString(),type:n==null?void 0:n.type,buttonLabel:(r=n==null?void 0:n.okLabel)===null||r===void 0?void 0:r.toString()}})}async function E(e,t){var a,r,n,i,l;const s=typeof t=="string"?{title:t}:t;return c({__tauriModule:"Dialog",message:{cmd:"askDialog",message:e.toString(),title:(a=s==null?void 0:s.title)===null||a===void 0?void 0:a.toString(),type:s==null?void 0:s.type,buttonLabels:[(n=(r=s==null?void 0:s.okLabel)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"Yes",(l=(i=s==null?void 0:s.cancelLabel)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:"No"]}})}async function N(e,t){var a,r,n,i,l;const s=typeof t=="string"?{title:t}:t;return c({__tauriModule:"Dialog",message:{cmd:"confirmDialog",message:e.toString(),title:(a=s==null?void 0:s.title)===null||a===void 0?void 0:a.toString(),type:s==null?void 0:s.type,buttonLabels:[(n=(r=s==null?void 0:s.okLabel)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"Ok",(l=(i=s==null?void 0:s.cancelLabel)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:"Cancel"]}})}const ee=Object.freeze(Object.defineProperty({__proto__:null,ask:E,confirm:N,message:x,open:L,save:S},Symbol.toStringTag,{value:"Module"}));var m;(function(e){e[e.Audio=1]="Audio",e[e.Cache=2]="Cache",e[e.Config=3]="Config",e[e.Data=4]="Data",e[e.LocalData=5]="LocalData",e[e.Desktop=6]="Desktop",e[e.Document=7]="Document",e[e.Download=8]="Download",e[e.Executable=9]="Executable",e[e.Font=10]="Font",e[e.Home=11]="Home",e[e.Picture=12]="Picture",e[e.Public=13]="Public",e[e.Runtime=14]="Runtime",e[e.Template=15]="Template",e[e.Video=16]="Video",e[e.Resource=17]="Resource",e[e.App=18]="App",e[e.Log=19]="Log",e[e.Temp=20]="Temp",e[e.AppConfig=21]="AppConfig",e[e.AppData=22]="AppData",e[e.AppLocalData=23]="AppLocalData",e[e.AppCache=24]="AppCache",e[e.AppLog=25]="AppLog"})(m||(m={}));async function V(e,t={}){return c({__tauriModule:"Fs",message:{cmd:"readTextFile",path:e,options:t}})}async function P(e,t={}){const a=await c({__tauriModule:"Fs",message:{cmd:"readFile",path:e,options:t}});return Uint8Array.from(a)}async function b(e,t,a){typeof a=="object"&&Object.freeze(a),typeof e=="object"&&Object.freeze(e);const r={path:"",contents:""};let n=a;return typeof e=="string"?r.path=e:(r.path=e.path,r.contents=e.contents),typeof t=="string"?r.contents=t??"":n=t,c({__tauriModule:"Fs",message:{cmd:"writeFile",path:r.path,contents:Array.from(new TextEncoder().encode(r.contents)),options:n}})}async function $(e,t,a){typeof a=="object"&&Object.freeze(a),typeof e=="object"&&Object.freeze(e);const r={path:"",contents:[]};let n=a;return typeof e=="string"?r.path=e:(r.path=e.path,r.contents=e.contents),t&&"dir"in t?n=t:typeof e=="string"&&(r.contents=t??[]),c({__tauriModule:"Fs",message:{cmd:"writeFile",path:r.path,contents:Array.from(r.contents instanceof ArrayBuffer?new Uint8Array(r.contents):r.contents),options:n}})}async function R(e,t={}){return c({__tauriModule:"Fs",message:{cmd:"readDir",path:e,options:t}})}async function z(e,t={}){return c({__tauriModule:"Fs",message:{cmd:"createDir",path:e,options:t}})}async function q(e,t={}){return c({__tauriModule:"Fs",message:{cmd:"removeDir",path:e,options:t}})}async function U(e,t,a={}){return c({__tauriModule:"Fs",message:{cmd:"copyFile",source:e,destination:t,options:a}})}async function J(e,t={}){return c({__tauriModule:"Fs",message:{cmd:"removeFile",path:e,options:t}})}async function Y(e,t,a={}){return c({__tauriModule:"Fs",message:{cmd:"renameFile",oldPath:e,newPath:t,options:a}})}async function Q(e,t={}){return c({__tauriModule:"Fs",message:{cmd:"exists",path:e,options:t}})}const te=Object.freeze(Object.defineProperty({__proto__:null,get BaseDirectory(){return m},get Dir(){return m},copyFile:U,createDir:z,exists:Q,readBinaryFile:P,readDir:R,readTextFile:V,removeDir:q,removeFile:J,renameFile:Y,writeBinaryFile:$,writeFile:b,writeTextFile:b},Symbol.toStringTag,{value:"Module"}));let g=!0,d=null;async function K(){try{return d=await T(()=>import("./sqliteDatabase-f219fdfc.js"),["assets/sqliteDatabase-f219fdfc.js","assets/index-5afd821c.js","assets/index-dc4438df.css"]),await d.initDatabase(),console.log("✅ SQLite veritabanı başarıyla başlatıldı"),localStorage.getItem("testdeck-data")&&(console.log("🔄 localStorage verilerinden SQLite'e geçiş başlatılıyor..."),await d.migrateFromLocalStorage()),!0}catch(e){return console.warn("⚠️ SQLite başlatılamadı, localStorage kullanılacak:",e),g=!1,!1}}let o={cards:[],sessions:[],attempts:[],stats:[],lastBackup:null};const k="testdeck-backup",A=1e3*60*10,p=e=>!(e.question&&e.subject&&e.difficulty)?!1:e.question_type==="fill_in_blank"?!!e.blank_answer:!!(e.option_a&&e.option_b&&e.option_c&&e.option_d&&e.correct_answer);function u(){if(o.cards.length>0||o.sessions.length>0)return;let e=!1;try{const t=localStorage.getItem("testdeck-data");if(t){const a=JSON.parse(t);a&&typeof a=="object"&&Array.isArray(a.cards)&&(o={...o,...a},e=!0,console.log("✅ Ana veriler başarıyla yüklendi."))}}catch(t){console.error("❌ Ana veriler yüklenirken hata oluştu:",t)}if(!e){console.warn("⚠️ Ana veri yüklenemedi. Yedek deneniyor...");try{const t=localStorage.getItem(k);if(t){const a=JSON.parse(t);a&&typeof a=="object"&&Array.isArray(a.cards)&&(o={...o,...a},console.log("✅ Yedek veriler başarıyla yüklendi."),_(),console.log("🔄 Ana veri yedekten geri yüklendi."))}else console.log("ℹ️ Yüklenecek yedek veri bulunamadı.")}catch(t){console.error("❌ Yedek veriler yüklenirken hata oluştu:",t)}}}function _(){try{console.log("💾 Veriler kaydediliyor...",{cards:o.cards.length,sessions:o.sessions.length,attempts:o.attempts.length,stats:o.stats.length});const e={...o,lastSaved:new Date().toISOString(),version:"1.0"},t=JSON.stringify(e),a=t.length/(1024*1024);console.log(`📦 Veri boyutu: ${a.toFixed(2)} MB`),a>4&&(console.log("⚠️ Veri çok büyük, temizlik yapılıyor..."),G()),localStorage.setItem("testdeck-data",t),console.log("✅ Veriler localStorage'a kaydedildi");const r=Date.now(),n=o.lastBackup?new Date(o.lastBackup).getTime():0;if(r-n>A&&a<3)try{localStorage.setItem(k,t),o.lastBackup=new Date().toISOString(),console.log("🔄 Backup oluşturuldu")}catch{console.log("⚠️ Backup oluşturulamadı, ana veri korundu")}console.log(`📊 Toplam ${o.cards.length} kart kaydedildi`)}catch(e){console.error("💥 Veri kaydetme hatası:",e);try{console.log("🧹 Agresif temizlik başlatılıyor..."),localStorage.removeItem("create-card-draft"),localStorage.removeItem("quick-card-draft");const t=[];for(let r=0;r<localStorage.length;r++){const n=localStorage.key(r);n&&!n.startsWith("testdeck-")&&t.push(n)}t.length>0&&(console.log(`🗑️ ${t.length} diğer key temizleniyor...`),t.forEach(r=>localStorage.removeItem(r)));const a={cards:o.cards,lastSaved:new Date().toISOString(),version:"1.0"};localStorage.setItem("testdeck-data",JSON.stringify(a)),console.log("✅ Temel veriler kaydedildi")}catch(t){console.error("💥 Retry save failed:",t),alert(`⚠️ Veri kaydedilemedi! Tarayıcı depolama alanı dolu.

📥 Öneriler:
• Verileri dışa aktarın
• Tarayıcı önbelleğini temizleyin
• Eski kartları silin`)}}}function G(){try{const e=Date.now()-2592e6,t=o.sessions.length;o.sessions=o.sessions.filter(r=>new Date(r.started_at).getTime()>e);const a=o.attempts.length;o.attempts=o.attempts.filter(r=>new Date(r.attempted_at).getTime()>e),console.log(`🧹 Temizlik: ${t-o.sessions.length} eski session, ${a-o.attempts.length} eski attempt silindi`)}catch(e){console.error("Cleanup error:",e)}}async function ae(){try{if(console.log("🚀 [Tauri] Export başlatılıyor..."),u(),!o.cards||o.cards.length===0){alert("⚠️ Export edilecek kart bulunamadı! Önce birkaç kart oluşturun.");return}const e={...o,exportDate:new Date().toISOString(),version:"1.0"},t=JSON.stringify(e,null,2),a=`testdeck-backup-${new Date().toISOString().split("T")[0]}.json`,r=await S({defaultPath:a,filters:[{name:"JSON Backup",extensions:["json"]}]});r?(await b(r,t),console.log(`✅ [Tauri] Veri başarıyla şuraya kaydedildi: ${r}`),alert(`✅ Veri başarıyla kaydedildi!

📁 Dosya: ${r}`)):console.log("ℹ️ [Tauri] Kullanıcı dosya kaydetme işlemini iptal etti.")}catch(e){console.error("💥 [Tauri] Export hatası:",e),alert("❌ Veri dışa aktarılamadı: "+e)}}async function re(e){try{const t=await e.text(),a=JSON.parse(t);if(!a.cards||!Array.isArray(a.cards))throw new Error("Invalid backup file format");const r=a.cards.filter(p);if(r.length===0)throw new Error("No valid cards found in backup");const n=new Set(o.cards.map(l=>l.id)),i=r.filter(l=>!n.has(l.id));return o.cards=[...o.cards,...i],a.sessions&&Array.isArray(a.sessions)&&(o.sessions=[...o.sessions,...a.sessions]),a.attempts&&Array.isArray(a.attempts)&&(o.attempts=[...o.attempts,...a.attempts]),a.stats&&Array.isArray(a.stats)&&(o.stats=[...o.stats,...a.stats]),_(),console.log(`Imported ${i.length} new cards`),!0}catch(t){return console.error("Import error:",t),alert("Veri içe aktarılamadı: "+((t==null?void 0:t.message)||"Bilinmeyen hata")),!1}}let w=null;const H=2e3;function f(){w&&clearTimeout(w),w=setTimeout(()=>{_()},H)}async function oe(){try{return console.log("🗄️ Veritabanı başlatılıyor..."),await K()?(console.log("✅ SQLite veritabanı başarıyla başlatıldı"),{type:"sqlite"}):(console.log("📦 localStorage kullanılıyor..."),u(),setInterval(()=>{_()},A),console.log(`✅ localStorage veritabanı başlatıldı - ${o.cards.length} kart yüklendi`),o)}catch(e){throw console.error("❌ Veritabanı başlatma hatası:",e),e}}async function ne(e){try{if(g&&d)return await d.createCard(e);if(!p(e))throw new Error("Invalid card data");const t={...e,id:Date.now()+Math.random(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return o.cards.push(t),f(),console.log("Card created:",t.id),t.id}catch(t){throw console.error("Create card error:",t),t}}async function se(e){try{if(g&&d){const a=e.filter(p),r=await d.createMultipleCards(a);return console.log(`Created ${r.length} cards in batch (sqlite)`),r}const t=e.filter(p).map(a=>({...a,id:Date.now()+Math.random(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()}));return o.cards.push(...t),f(),console.log(`Created ${t.length} cards in batch`),t.map(a=>a.id)}catch(t){throw console.error("Batch create error:",t),t}}async function ie(){return g&&d?await d.getAllCards():(u(),o.cards.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()))}async function le(e){return u(),o.cards.filter(t=>t.subject===e).sort((t,a)=>new Date(a.created_at).getTime()-new Date(t.created_at).getTime())}async function ce(e,t){try{u();const a=o.cards.findIndex(r=>r.id===e);return a!==-1&&(o.cards[a]={...o.cards[a],...t,updated_at:new Date().toISOString()},f(),console.log("Card updated:",e)),!0}catch(a){throw console.error("Update card error:",a),a}}async function de(e){try{if(g&&d)return await d.deleteCard(e),!0;u();const t=o.cards.length;return o.cards=o.cards.filter(a=>a.id!==e),o.cards.length<t&&(f(),console.log("Card deleted:",e)),!0}catch(t){throw console.error("Delete card error:",t),t}}async function ue(){try{if(g&&d){await d.deleteAllCards();return}u(),o.cards=[],o.attempts=[],o.sessions=[],o.stats=[],f(),console.log("🧹 All local cards and related data cleared")}catch(e){throw console.error("Delete all cards error:",e),e}}async function fe(e){try{const t={...e,id:Date.now()+Math.random()};return o.sessions.push(t),f(),t.id}catch(t){throw console.error("Create session error:",t),t}}async function ge(e,t){try{const a=o.sessions.findIndex(r=>r.id===e);return a!==-1&&(o.sessions[a]={...o.sessions[a],ended_at:new Date().toISOString(),correct_answers:t},f()),!0}catch(a){throw console.error("End session error:",a),a}}async function me(e){try{const t={...e,id:Date.now()+Math.random(),attempted_at:new Date().toISOString()};return o.attempts.push(t),await W(e.card_id,e.is_correct),f(),t.id}catch(t){throw console.error("Record attempt error:",t),t}}async function W(e,t){try{u();let a=o.stats.find(n=>n.card_id===e);a||(a={id:Date.now()+Math.random(),card_id:e,total_attempts:0,correct_attempts:0,last_attempt:null,next_review:new Date().toISOString(),ease_factor:2.5,interval_days:1,repetitions:0},o.stats.push(a)),a.total_attempts+=1,t?(a.correct_attempts+=1,a.repetitions+=1,a.repetitions===1?a.interval_days=1:a.repetitions===2?a.interval_days=6:a.interval_days=Math.round(a.interval_days*a.ease_factor),a.ease_factor=Math.max(1.3,a.ease_factor+(.1-(5-4)*(.08+(5-4)*.02)))):(a.repetitions=0,a.interval_days=1,a.ease_factor=Math.max(1.3,a.ease_factor-.2)),a.last_attempt=new Date().toISOString();const r=new Date;r.setDate(r.getDate()+a.interval_days),a.next_review=r.toISOString(),f()}catch(a){throw console.error("Update card stats error:",a),a}}async function pe(){try{u(),console.log("📊 getSubjectStats çağrıldı. Mock data:",{cards:o.cards.length,sessions:o.sessions.length,attempts:o.attempts.length,stats:o.stats.length});const e={};return o.cards.forEach(t=>{e[t.subject]||(e[t.subject]={name:t.subject,total_cards:0,accuracy:0,last_studied:null,total_attempts:0,correct_attempts:0}),e[t.subject].total_cards+=1}),o.attempts.forEach(t=>{const a=o.cards.find(r=>r.id===t.card_id);a&&e[a.subject]&&(e[a.subject].total_attempts+=1,t.is_correct&&(e[a.subject].correct_attempts+=1),(!e[a.subject].last_studied||new Date(t.attempted_at)>new Date(e[a.subject].last_studied))&&(e[a.subject].last_studied=t.attempted_at))}),o.stats.forEach(t=>{const a=o.cards.find(r=>r.id===t.card_id);a&&e[a.subject]&&t.total_attempts>0&&e[a.subject].total_attempts===0&&(e[a.subject].total_attempts+=t.total_attempts,e[a.subject].correct_attempts+=t.correct_attempts,(!e[a.subject].last_studied||new Date(t.last_attempt)>new Date(e[a.subject].last_studied))&&(e[a.subject].last_studied=t.last_attempt))}),Object.values(e).forEach(t=>{t.accuracy=v(t.correct_attempts,t.total_attempts,0)}),Object.values(e)}catch(e){return console.error("Get subject stats error:",e),[]}}async function _e(e=30){try{u();const t={},a=new Date;for(let r=0;r<e;r++){const n=new Date(a);n.setDate(n.getDate()-r);const i=n.toISOString().split("T")[0];t[i]={date:i,questions_answered:0,correct_answers:0,accuracy:0,study_time:0,cards_created:0}}return o.attempts.forEach(r=>{const n=r.attempted_at.split("T")[0];t[n]&&(t[n].questions_answered+=1,r.is_correct&&(t[n].correct_answers+=1),t[n].study_time+=(r.time_spent||30)/60)}),o.cards.forEach(r=>{const n=r.created_at.split("T")[0];t[n]&&(t[n].cards_created+=1)}),Object.values(t).forEach(r=>{r.accuracy=v(r.correct_answers,r.questions_answered,0);const n=Number(r.study_time)||0;r.study_time=n>0?I(n,1):0}),Object.values(t).filter(r=>{const n=new Date(r.date),i=new Date(a);return i.setDate(i.getDate()-e),n>=i}).sort((r,n)=>new Date(r.date).getTime()-new Date(n.date).getTime())}catch(t){return console.error("Get daily stats error:",t),[]}}var Z={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const X=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ye=(e,t)=>{const a=y.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,children:s,...D},j)=>y.createElement("svg",{ref:j,...Z,width:n,height:n,stroke:r,strokeWidth:l?Number(i)*24/Number(n):i,className:`lucide lucide-${X(e)}`,...D},[...t.map(([C,O])=>y.createElement(C,O)),...(Array.isArray(s)?s:[s])||[]]));return a.displayName=`${e}`,a};export{ne as a,pe as b,ye as c,_e as d,le as e,fe as f,ie as g,ge as h,oe as i,se as j,de as k,I as l,ae as m,re as n,ue as o,F as p,ee as q,me as r,v as s,te as t,ce as u};
